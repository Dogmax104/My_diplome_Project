@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
}
@model General_Admin
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="./output.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/flowbite@2.5.2/dist/flowbite.min.css" rel="stylesheet" />



    <!-- Scripts -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="../path/to/flowbite/dist/flowbite.min.js"></script>

    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.25/css/jquery.dataTables.min.css">
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.25/js/jquery.dataTables.min.js"></script>

</head>


<!-- Tab2 -->
<div id="tab2" class="tabcontent p-4 mx-auto justify-center hidden">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-8 ">
        <div class="flex justify-center">
            <table id="example2" class="table-auto w-full bg-white mx-auto">
                <thead class="bg-orange-500">
                    <tr>
                        <th class="px-4 py-2">П/п</th>
                        <th class="px-4 py-2">Id заказа</th>
                        <th class="px-4 py-2">Имя проекта/изделие</th>
                        <th class="px-4 py-2">Заказчик:фирма/ответственное лицо за заказ/телефон/адрес</th>
                        <th class="px-4 py-2">Дата поступления заказа</th>
                        <th class="px-4 py-2">Дата согласования заказа</th>
                        <th class="px-4 py-2">Прилагаемые файлы</th>
                        <th class="px-4 py-2">Файл для согласования</th>
                        <th class="px-4 py-2">Заказ в производство</th>
                        <th class="px-4 py-2">Статус заказа</th>
                        <th class="px-4 py-2">Примечания</th>
                        <th class="px-4 py-2"></th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="border px-4 py-2"></td>
                        <td class="border px-4 py-2"></td>
                        <td class="border px-4 py-2"></td>
                        <td class="border px-4 py-2"></td>
                        <td class="border px-4 py-2"></td>
                        <td class="border px-4 py-2"></td>
                        <td class="border px-4 py-2"></td>
                        <td class="border px-4 py-2"></td>
                        <td class="border px-4 py-2"></td>
                        <td class="border px-4 py-2"></td>
                        <td class="border px-4 py-2"></td>
                        <td class="border px-4 py-2">
                            <div x-data="{ open: false }" class="relative">
                                <!-- Кнопка открытия формы -->
                                <button @@click="open = true" class="justify-center transform motion-safe:hover:scale-90 text-4xl text-white bg-gray-800 border-0 py-2 px-8 focus:outline-none hover:bg-orange-600 rounded-l-lg rounded-tr-lg shadow-2xl text-lg">
                                    +
                                </button>

                                <!-- Затемненный фон -->
                                <div x-show="open" x-transition.opacity x-cloak @@click="open = false" class="fixed inset-0 bg-gray-900 bg-opacity-50 z-40"></div>

                                <!-- Модальное окно -->
                                <div x-show="open" x-transition @@keydown.escape.window="open = false" x-cloak
                                     class="fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-full max-w-lg bg-white border border-4 rounded-lg shadow-lg p-6 z-50 overflow-y-auto max-h-screen">

                                    <!-- Заголовок -->
                                    <div class="flex items-start justify-between p-5 border-b rounded-t">
                                        <h3 class="text-xl font-semibold">Новый заказ</h3>
                                        <button @@click="open = false" class="text-gray-400 hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm p-1.5">
                                            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                                                <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                                            </svg>
                                        </button>
                                    </div>

                                    <!-- Форма -->
                                    <form asp-controller="TaskPage" asp-action="CreateProjectModel" class="space-y-4" enctype="multipart/form-data">
                                        @* Название проекта *@
                                        <div>
                                            <label class="text-sm font-medium text-gray-800">Название проекта</label>
                                            <input type="text" name="NameProjectModel" class="w-full p-2 border rounded-lg" placeholder="Имя проекта">
                                        </div>
                                        @* Данные по  заказчику *@
                                        <div>
                                            <label class="text-sm font-medium text-gray-800">Данные по заказчику</label>
                                            <input type="text" name="ClientNameProjectModel" class="w-full p-2 border rounded-lg" placeholder="Electronics">
                                        </div>
                                        @* Дата поступления заказа *@
                                        <div>
                                            <label class="text-sm font-medium text-gray-800">Дата поступления заказа</label>
                                            <input name="BeginTime" type="date" class="w-full p-2 border rounded-lg" placeholder="Дата поступления заказа">
                                        </div>
                                        @* Дата согласования заказа *@
                                        <div>
                                            <label class="text-sm font-medium text-gray-800">Дата согласования заказа</label>
                                            <input name="CoordinationTime" type="date" class="w-full p-2 border rounded-lg" placeholder="Electronics">
                                        </div>
@* Тут нужно будет прописать получение файлов *@
@* !!!!!!!!!!!!!! *@
                                        <div>
                                            <label class="text-sm font-medium text-gray-800">Прилагаемые файлы</label>
                                            <input type="file" name="file" multiple class="w-full p-2 border rounded-lg" placeholder="Выбрать файлы">
                                            <input type="hidden" name="PageadminFlag" value="pageadmin"/>
                                        </div>
@* Тут будет добовление файлов от конструктора для согласования в производство; *@
@* !!!!!!!!!!!!!! *@
                                        <div>
                                            <label class="text-sm font-medium text-gray-800">Файл на согласование</label>
                                            <input type="file" class="w-full p-2 border rounded-lg" placeholder="Electronics">
                                        </div>
                                        @* Заказ в производство bool *@
                                        <div>
                                            <input type="hidden" id="hidden-field" name="OrderInManufaction" value="false" />
                                            <input id="red-checkbox" type="checkbox" value="true" class="w-4 h-4 text-red-600 bg-gray-100 border-gray-300 rounded-sm focus:ring-red-500 dark:focus:ring-red-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600" onchange="document.getElementById('hidden-field').value = this.checked ? 'true' : 'false'">
                                            <label for="red-checkbox" class="ms-2 text-sm font-medium text-gray-900 dark:text-gray-300">Заказ в производство</label>
                                        </div>
                                        <div>
                                            @* статус заказа в int значение; *@
                                            <label class="text-sm font-medium text-gray-800">Статус заказа</label>
                                            <input name="StatusOrder" type="number" class="w-full p-2 border rounded-lg" placeholder="статус заказа">
                                        </div>
                                        @* Заметки для заказа *@
                                        <div>
                                            <label class="text-sm font-medium text-gray-800">Примечание</label>
                                            <input name="NotesProjectModel" type="text" class="w-full p-2 border rounded-lg" placeholder="Примечание">
                                        </div>
                                        <button type="submit" class="w-full bg-gray-800 hover:bg-orange-500 text-white font-medium rounded-l-lg rounded-tr-lg px-5 py-2.5 text-center">
                                            Добавить
                                        </button>
                                    </form>
                                </div>
                            </div>
                        </td>
                    </tr>

                @* Список для вывода данных в таблицу *@
                @{
                    if (Model == null)
                    {
                        <p>нет данных</p>
                    }
                    else
                    {
                        // Блок для которого будет выполняться логика для отображения списка в таблице
                        {
                            foreach (var item in Model.ProgectModel)
                            {
                                <tr>
                                    <td class="border px-4 py-2"></td>
                                    <td class="border px-4 py-2">@item.IdProjectModel.ToString("D5")</td>
                                    <td class="border px-4 py-2">@item.NameProjectModel</td>
                                    <td class="border px-4 py-2">@item.ClientNameProjectModel</td>
                                    <td class="border px-4 py-2">@item.BeginTime.ToString("dd.MM.yy")</td>
                                    <td class="border px-4 py-2">@item.CoordinationTime.ToString("dd.MM.yy")</td>
                                    <td class="border px-4 py-2">
                                        @foreach (var files in item.ClientFileProjectModel) @*передача файлов*@
                                        {
                                            <ul style="list-style-type">
                                                <list>@files.NameModelFileClient</list>
                                            </ul>
                                        }
                                    </td>

                                    @*Начало .. Файлы для согласования*@
                                    <td class="border px-4 py-2">
                                        Нет файлов
                                        <label class="block mb-2 text-sm font-medium text-gray-900 dark:text-white" for="multiple_files"></label>
                                        <input class="block w-full text-sm text-gray-900 border border-gray-300 rounded-lg cursor-pointer bg-gray-50 dark:text-gray-400 focus:outline-none dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400" id="multiple_files" type="file" multiple>
                                    </td>  @*Конец .. Файлы для согласования*@

                                    @*Запуск в производство*@
                                    <td class="border px-4 py-2">
                                        @{
                                            if (item.OrderInManufaction == true)
                                            {
                                                <img src="@Url.Content("~/Image_project/Ok.jpg")" class="rounded mx-auto d-block" height="30" width="30">
                                            }
                                        }
                                    </td>
                                    @*Блок статуса заказа*@
                                    <td class="border px-4 py-2 align-middle text-xs whitespace-nowrap p-4">
                                        <div class="flex items-center">
                                            <span class="mr-2 text-xs font-medium">@item.StatusOrder%</span>
                                            <div class="relative w-full">
                                                <div class="w-full bg-gray-200 rounded-sm h-2">
                                                    <div class="bg-cyan-600 h-2 rounded-sm" style="width: @item.StatusOrder%"></div>
                                                </div>
                                            </div>
                                        </div>
                                    </td>
                                    @*Конец блока статуса заказа *@
                                    <td class="border px-4 py-2"> @item.NotesProjectModel;</td>
                                        @* Кнопка для удаления пользователя *@
                                    <td >
                                            <form method="post" asp-controller="Admin_panell" asp-action="DeleteTask">
                                        <button class="text-gray-800  text-sm bg-white hover:bg-orange-300 border-y border-gray-100 rounded-l-lg rounded-tr-lg font-medium px-4 py-2 inline-flex space-x-1 items-center">
                                            <img src=@Url.Content("~/image_project/icons8-мусор.svg") alt="Корзина с мусором" width="30" height="30" />
                                            <input type="hidden" name="IdProjectModel" value="@item.IdProjectModel" />
                                        </button>
                                        </form>
                                    </td>
                                </tr>
                            }
                        }
                    }
                }
                </tbody>
            </table>
        </div>
    </div>
 </div>



<style>
    .dataTables_length select {
        width: 60px; /* Измените значение по вашему усмотрению */
        height: 40px; /* Измените значение по вашему усмотрению */
        font-size: 14px; /* Измените значение по вашему усмотрению */
    }

    table tbody tr {
        counter-increment: rowNumber;
    }

    table tbody tr td:first-child::before {
        content: counter(rowNumber);
    }
        /* Сбрасываем счётчик до "0" перед третьей строкой */
        table tbody tr:nth-child(2) {
            counter-reset: rowNumber 0; /* Сброс значения счётчика на 0 перед третьей строкой */
        }
    /* Сброс счетчика для первых двух строк */
    table tbody tr:nth-child(-n+1) td:first-child::before {
        content: ""; /* Убираем нумерацию */
        counter-increment: none; /* Не увеличиваем счетчик */
    }

</style>

<script>
    $(document).ready(function () {
        $('#example').DataTable({
            // Add any customization options here
        });
    });
</script>